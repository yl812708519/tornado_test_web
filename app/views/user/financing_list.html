{% extends "../layouts/application.html" %}
{% autoescape %}
{% block description %}{{"登陆冰狗会员中心可以发布专利转让、求购，商标转让、求购，专利申请、商标申请、版权申请等知识产权保护的服务信息"}}{% end %}
{% block keywords %}{{"融资项目,专利转让,商标转让,专利申请,商标申请,版权申请"}}{% end %}
{% block left %}
{% end %}
{% block body %}
<!--商标融资页面  -->
<div class="patent_application">
	<div class="container right-content">
        <div class="row">
            {% include "../layouts/left.html"%}
            <div class="col-md-10 top">
                <div class="col-md-10 col-xs-10 col-sm-9">
                    <div class="color"></div>
                    <div class="content_title">融资项目</div>
                    <br style="clear:both;">
                </div>
                {% if total_count != 0 %}
                <div class="col-md-2 col-sm-2"><a href="/financing/add" class="btn btn-danger btn_add_sty"><span class="glyphicon glyphicon-plus"></span>添加融资项目</a></div>
                {%end%}
                <!--添加融资-->
                {% if total_count == 0%}
                <div class="col-sm-12" style="margin-top: 30px">
                    <div class="col-sm-4"></div>
                        <div class="col-sm-4 yet_sty">
                        如果您有需要的融资项目
                        </div>
                    <div class="col-sm-4"></div>
                </div>
                <div class="col-sm-12">
                    <div class="col-sm-4"></div>
                        <div class="col-sm-4 yet_stys">
                            <a href="/financing/add" class="btn btn-danger btn_add_sty"><span class="glyphicon glyphicon-plus"style="margin-right: 5px"></span>添加融资项目</a>
                        </div>
                    <div class="col-sm-4"></div>
                </div>
                {%end%}
                <div  class="panel-body col-sm-12 list_sty_div">
                    <div class="table-responsive">
                        {% if total_count != 0%}
                        <table class="table table-striped table-bordered table-hover" style="border:none;">
                            <thead>
                                <tr style="background-color: #EDF9FF;border: 1px solid #e1e1e1">
                                    <th style="width:60px;border:none" class="th_sty"></th>
                                    <th class="th_sty" style="border:none;">产品名称</th>
                                    <th class="th_sty" style="border:none;">申请人</th>
                                    <th class="th_sty" style="border:none;">创建时间</th>
                                    <th class="th_sty" style="border:none;">项目状态</th>
                                    <th class="th_sty" style="border:none;">操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for fin in financings%}
                                <tr class="th_sty" style=" border: 1px solid #e1e1e1">
                                    <td style="border:none;">
                                         {%if fin.is_recommend == 1%}
                                            <span class="tuijian_sty" >
                                                推荐
                                            </span>
                                        {%end%}
                                    </td>
                                    <td class="algin_sty" style="border:none;">
                                        <span>{{fin.financing_name}}</span>
                                    </td>
                                    <td  class="algin_sty" style="border:none;">{{current_user.name}}</td>
                                    <td  class="algin_sty" style="border:none;">{{fin.created_date}}</td>
                                    <td  class="algin_stys" style="border:none;">
                                        {% if fin.status == 0 %}
                                            <div class="review-btn">{{fin.status_detail}}</div>
                                        {% elif fin.status == 1 %}
                                            <div class="paid-btn">{{fin.status_detail}}</div>
                                        {% elif fin.status == 2 %}
                                            <div class="invalid-btn">{{fin.status_detail}}</div>
                                        {% end %}
                                    </td>
                                    <td class="algin_sty"  style="cursor:default;border:none;">
                                        <input type="hidden" name="fin_id" value="{{fin.id}}"/>
                                        {% if fin.status== 2 %}
                                        <a style="margin-right: 5px;vertical-align: middle" href="/financing/{{fin.id}}/edit">编辑</a>|<a class="delete_financing" style="margin-left: 5px" href="javascript:;" data="{{fin.id}}" name="delete">删除</a>
                                        {% else %}
                                            {% if fin.status != 1%}
                                               <span style="margin-right: 5px;color: #ccc;">编辑</span>|<a class="delete_financing" style="margin-left: 5px" href="javascript:;" data="{{fin.id}}" name="delete">删除</a>
                                            {% else %}
                                               <span style="margin-right: 5px;color: #ccc;">编辑</span>|<a class="delete_financing" style="margin-left: 5px;color: #ccc;cursor:default" href="javascript:;" data="{{fin.id}}">删除</a>
                                            {% end %}
                                        {% end %}
                                        |<a class="delete_financing" style="margin-right: 5px" href="/financing/{{fin.id}}" data="{{fin.id}}">查看</a>
                                    </td>
                                 </tr>
                            {%end%}
                            </tbody>
                        </table>
                        <div class="wtable-footer col-md-12">
                            <div id="pagination-container" class="paging_sty"></div>
                        </div>
                        {%end%}
                    </div>
                </div>
            </div>
         </div>
    </div>
</div>
{% end %}
{% block javascript %}
<script type="text/javascript" src="{{static_url('js/w-page.min.js')}}"></script>
<script>
$('#financing').addClass('current');
    $(function(){
        /*分页开始*/
        fixed_footer();
        var currentPage = {{current_page}};
        var totalPage = {{total_page}};
        $('#pagination-container').wPage({
            currentPage:currentPage,    // 当前页 默认 1
            totalPage:totalPage,     // 总页数 默认 1
            firstCount: 1,      // 1 ... 3 4 5 ... 108首页处预览页数 默认 1
            lastCount: 1,       // 1 ... 3 4 5 ... 108尾页处预览页数 默认 1
            prevCount: 2,       // 当前页前预览页数 默认 2
            nextCount: 6,       // 当前页后预览页数 默认 6
            clickCallBack:function (pageNum, $element){
                 window.location.href='/user/financings?currentPage='+pageNum;
            }
        });
        /*分页结束*/
        $("a[name=delete]").click(function(){
            var $tr = $(this).parents("tr");
            var financing_id = $(this).siblings("input").val();
            wModalDialog({
                content: ('您确定删除此条记录码？'),
                showAnimate: false,
                type: "confirm",
                sureCallBack:function(){
                    var params = {};
                    params["id"] = financing_id;
                    params["_xsrf"] = $("input[name=_xsrf]").val();
                    params["_method"] = 'delete';
                    $.ajax({
                        type: "POST",
                        url: "/financing/delete",
                        data: params,
                        dataType: "json",
                        success: function(data){
                            var odata=eval(data);
                            if (odata.result == 1){
                                $tr.remove();
                                wModalDialog({
                                    content: ('删除成功!'),
                                    showAnimate: true,
                                    type: "success",
                                    cancelCallBack:function(){
                                        //location.reload();
                                    }
                                });
                            }else{
                                wModalDialog({
                                    content: (data.msg),
                                    showAnimate: true,
                                    type: "failed"
                                });
                            }
                        },
                        error: function (data) {
                            var err = data.responseJSON
                            wModalDialog({
                                content: (err.msg),
                                showAnimate: true,
                                type: "failed"
                            });
                        }
                    });// end of $.ajax
                }// end of sureCallBack
            });// end of wModalDialog

        });


    });

</script>
{%end%}

